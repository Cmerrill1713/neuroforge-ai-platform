{
  "id": "meta_github_61702909",
  "title": "deepmask",
  "description": "Torch implementation of DeepMask and SharpMask",
  "url": "https://github.com/facebookresearch/deepmask",
  "language": "Lua",
  "stars": 3106,
  "forks": 503,
  "created_at": "2016-06-22T08:37:18Z",
  "updated_at": "2025-09-24T04:32:34Z",
  "topics": [],
  "readme_content": "# Introduction\nThis repository contains a [Torch](http://torch.ch) implementation for both the [DeepMask](http://arxiv.org/abs/1506.06204) and [SharpMask](http://arxiv.org/abs/1603.08695) object proposal algorithms.\n\n![teaser](https://raw.githubusercontent.com/facebookresearch/deepmask/master/data/teaser.png)\n\n[DeepMask](http://arxiv.org/abs/1506.06204) is trained with two objectives: given an image patch, one branch of the model outputs a class-agnostic segmentation mask, while the other branch outputs how likely the patch is to contain an object. At test time, DeepMask is applied densely to an image and generates a set of object masks, each with a corresponding objectness score. These masks densely cover the objects in an image and can be used as a first step for object detection and other tasks in computer vision.\n\n[SharpMask](http://arxiv.org/abs/1603.08695) is an extension of DeepMask which generates higher-fidelity masks using an additional top-down refinement step. The idea is to first generate a coarse mask encoding in a feedforward pass, then refine this mask encoding in a top-down pass using features at successively lower layers. This result in masks that better adhere to object boundaries.\n\nIf you use DeepMask/SharpMask in your research, please cite the relevant papers:\n```\n@inproceedings{DeepMask,\n   title = {Learning to Segment Object Candidates},\n   author = {Pedro O. Pinheiro and Ronan Collobert and Piotr Dollár},\n   booktitle = {NIPS},\n   year = {2015}\n}\n```\n```\n@inproceedings{SharpMask,\n   title = {Learning to Refine Object Segments},\n   author = {Pedro O. Pinheiro and Tsung-Yi Lin and Ronan Collobert and Piotr Dollár},\n   booktitle = {ECCV},\n   year = {2016}\n}\n```\nNote: the version of DeepMask implemented here is the updated version reported in the SharpMask paper. DeepMask takes on average .5s per COCO image, SharpMask runs at .8s. Runtime roughly doubles for the \"zoom\" versions of the models.\n\n# Requirements and Dependencies\n* MAC OS X or Linux\n* NVIDIA GPU with compute capability 3.5+\n* [Torch](http://torch.ch) with packages: [COCO API](https://github.com/pdollar/coco), [image](https://github.com/torch/image), [tds](https://github.com/torch/tds), [cjson](https://github.com/clementfarabet/lua---json), [nnx](https://github.com/clementfarabet/lua---nnx), [optim](https://github.com/torch/optim), [inn](https://github.com/szagoruyko/imagine-nn), [cutorch](https://github.com/torch/cutorch), [cunn](https://github.com/torch/cunn), [cudnn](https://github.com/soumith/cudnn.torch)\n\n# Quick Start\nTo run pretrained DeepMask/SharpMask models to generate object proposals, follow these steps:\n\n1. Clone this repository into $DEEPMASK:\n\n   ```bash\n   DEEPMASK=/desired/absolute/path/to/deepmask/ # set absolute path as desired\n   git clone git@github.com:facebookresearch/deepmask.git $DEEPMASK\n   ```\n\n2. Download pre-trained DeepMask and SharpMask models:\n\n   ```bash\n   mkdir -p $DEEPMASK/pretrained/deepmask; cd $DEEPMASK/pretrained/deepmask\n   wget https://dl.fbaipublicfiles.com/deepmask/models/deepmask/model.t7\n   mkdir -p $DEEPMASK/pretrained/sharpmask; cd $DEEPMASK/pretrained/sharpmask\n   wget https://dl.fbaipublicfiles.com/deepmask/models/sharpmask/model.t7\n   ```\n\n3. Run `computeProposals.lua` with a given model and optional target image (specified via the `-img` option):\n\n   ```bash\n   # apply to a default sample image (data/testImage.jpg)\n   cd $DEEPMASK\n   th computeProposals.lua $DEEPMASK/pretrained/deepmask # run DeepMask\n   th computeProposals.lua $DEEPMASK/pretrained/sharpmask # run SharpMask\n   th computeProposals.lua $DEEPMASK/pretrained/sharpmask -img /path/to/image.jpg\n   ```\n\n\n# Training Your Own Model\nTo train your own DeepMask/SharpMask models, follow these steps:\n\n## Preparation\n1. If you have not done so already, clone this repository into $DEEPMASK:\n\n   ```bash\n   DEEPMASK=/desired/absolute/path/to/deepmask/ # set absolute path as desired\n   git clone git@github.com:facebookresearch/deepmask.git $DEEPMASK\n   ```\n\n2. Download the Torch [ResNet-50](https://dl.fbaipublicfiles.com/deepmask/models/resnet-50.t7) model pretrained on ImageNet:\n\n   ```bash\n   mkdir -p $DEEPMASK/pretrained; cd $DEEPMASK/pretrained\n   wget https://dl.fbaipublicfiles.com/deepmask/models/resnet-50.t7\n   ```\n\n3. Download and extract the [COCO](http://mscoco.org/) images and annotations:\n\n   ```bash\n   mkdir -p $DEEPMASK/data; cd $DEEPMASK/data\n   wget http://msvocds.blob.core.windows.net/annotations-1-0-3/instances_train-val2014.zip\n   wget http://msvocds.blob.core.windows.net/coco2014/train2014.zip\n   wget http://msvocds.blob.core.windows.net/coco2014/val2014.zip\n   ```\n\n## Training\nTo train, launch the `train.lua` script. It contains several options, to list them, simply use the `--help` flag.\n\n1. To train DeepMask:\n\n   ```bash\n   th train.lua\n   ```\n\n2. To train SharpMask (requires pre-trained DeepMask model):\n\n   ```bash\n   th train.lua -dm /path/to/trained/deepmask/\n   ```\n\n## Evaluation\nThere are two ways to evaluate a model on the COCO dataset.\n\n1. `evalPerPatch.lua` evaluates only the mask generation step. The per-patch evaluation only uses image patches that contain roughly centered objects. Its usage is as follows:\n\n   ```bash\n   th evalPerPatch.lua /path/to/trained/deepmask-or-sharpmask/\n   ```\n\n2. `evalPerImage.lua` evaluates the full model on COCO images, as reported in the papers. By default, it evaluates performance on the first 5K COCO validation images (run `th evalPerImage.lua --help` to see the options):\n\n   ```bash\n   th evalPerImage.lua /path/to/trained/deepmask-or-sharpmask/\n   ```\n\n\n# Precomputed Proposals\n\nYou can download pre-computed proposals (1000 per image) on the COCO and PASCAL VOC datasets, for both segmentation and bounding box proposals. We use the COCO JSON [format](http://mscoco.org/dataset/#format) for the proposals. The proposals are divided into chunks of 500 images each (that is, each JSON contains 1000 proposals per image for 500 images). All proposals correspond to the \"zoom\" setting in the paper (DeepMaskZoom and SharpMaskZoom) which tend to be most effective for object detection.\n\n## DeepMask\n* COCO Boxes: [[train](https://dl.fbaipublicfiles.com/deepmask/boxes/deepmask-coco-train-bbox.tar.gz) | [val](https://dl.fbaipublicfiles.com/deepmask/boxes/deepmask-coco-val-bbox.tar.gz) | [test-dev](https://dl.fbaipublicfiles.com/deepmask/boxes/deepmask-coco-test-dev-bbox.tar.gz) | [test-full](https://dl.fbaipublicfiles.com/deepmask/boxes/deepmask-coco-test-full-bbox.tar.gz)]\n* COCO Segments: [[train](https://dl.fbaipublicfiles.com/deepmask/segms/deepmask-coco-train.tar.gz) | [val](https://dl.fbaipublicfiles.com/deepmask/segms/deepmask-coco-val.tar.gz) | [test-dev](https://dl.fbaipublicfiles.com/deepmask/segms/deepmask-coco-test-dev.tar.gz) | [test-full](https://dl.fbaipublicfiles.com/deepmask/segms/deepmask-coco-test-full.tar.gz)]\n* PASCAL Boxes: [[train+val+test-2007](https://dl.fbaipublicfiles.com/deepmask/boxes/deepmask-pascal07-bbox.tar.gz) | [train+val+test-2012](https://dl.fbaipublicfiles.com/deepmask/boxes/deepmask-pascal12-bbox.tar.gz)]\n* PASCAL Segments: [[train+val+test-2007](https://dl.fbaipublicfiles.com/deepmask/segms/deepmask-pascal07.tar.gz) | [train+val+test-2012](https://dl.fbaipublicfiles.com/deepmask/segms/deepmask-pascal12.tar.gz)]\n\n## SharpMask\n* COCO Boxes: [[train](https://dl.fbaipublicfiles.com/deepmask/boxes/sharpmask-coco-train-bbox.tar.gz) | [val](https://dl.fbaipublicfiles.com/deepmask/boxes/sharpmask-coco-val-bbox.tar.gz) | [test-dev](https://dl.fbaipublicfiles.com/deepmask/boxes/sharpmask-coco-test-dev-bbox.tar.gz) | [test-full](https://dl.fbaipublicfiles.com/deepmask/boxes/sharpmask-coco-test-full-bbox.tar.gz)]\n* COCO Segments: [[train](https://dl.fbaipublicfiles.com/deepmask/segms/sharpmask-coco-train.tar.gz) | [val](https://dl.fbaipublicfiles.com/deepmask/segms/sharpmask-coco-val.tar.gz) | [test-dev](https://dl.fbaipublicfiles.com/deepmask/segms/sharpmask-coco-test-dev.tar.gz) | [test-full](https://dl.fbaipublicfiles.com/deepmask/segms/sharpmask-coco-test-full.tar.gz)]\n* PASCAL Boxes: [[train+val+test-2007](https://dl.fbaipublicfiles.com/deepmask/boxes/sharpmask-pascal07-bbox.tar.gz) | [train+val+test-2012](https://dl.fbaipublicfiles.com/deepmask/boxes/sharpmask-pascal12-bbox.tar.gz)]\n* PASCAL Segments: [[train+val+test-2007](https://dl.fbaipublicfiles.com/deepmask/segms/sharpmask-pascal07.tar.gz) | [train+val+test-2012](https://dl.fbaipublicfiles.com/deepmask/segms/sharpmask-pascal12.tar.gz)]\n",
  "source_type": "meta_github_repository",
  "domain": "meta_ai",
  "keywords": [],
  "retrieval_tags": [
    "meta",
    "ai",
    "github",
    "repository",
    "research"
  ]
}